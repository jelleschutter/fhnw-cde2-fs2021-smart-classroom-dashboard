(this["webpackJsonpsmart-classroom-dashboard"]=this["webpackJsonpsmart-classroom-dashboard"]||[]).push([[0],{203:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),c=n(37),a=n.n(c),s=n(9),i=(n(91),n(16)),u=n(80),l=n(3),d=(n(92),n(38)),b={loggedIn:!1,token:localStorage.getItem("token")},j=Object(d.b)({name:"auth",initialState:b,reducers:{login:function(e,t){e.loggedIn=!0,e.token=t.payload,localStorage.setItem("token",t.payload)},logout:function(e){e.loggedIn=!1,e.token="",localStorage.setItem("token",null)}}}),h=j.actions,g=h.login,m=h.logout,O=j.reducer,f=n(1),p=function(e){var t=e.onSensorChange,n=Object(r.useState)([]),o=Object(i.a)(n,2),c=o[0],a=o[1],u=Object(s.b)(),l=Object(s.c)((function(e){return e.auth})),d=Object(r.useCallback)(t,[t]);Object(r.useEffect)((function(){if(l.loggedIn){var e=new Headers;e.set("Authorization","Basic ".concat(l.token)),fetch('https://glusfqycvwrucp9-db202012181437.adb.eu-zurich-1.oraclecloudapps.com/ords/sensor_datalake/sens/sensors?q={"$orderby":{"title":"asc"}}',{method:"GET",headers:e}).then((function(e){return e.ok?e.json():(u(m()),Promise.reject(new Error(e.statusText)))})).then((function(e){var t,n,r=null!==(t=null===(n=e.items[0])||void 0===n?void 0:n.uuid)&&void 0!==t?t:"";a(e.items),d(r)})).catch((function(e){console.log(e),d("")}))}else a([])}),[u,d,l]);var b=c.map((function(e){return Object(f.jsx)("option",{value:e.uuid,children:e.title},e.uuid)}));return Object(f.jsx)("select",{onChange:function(e){d(e.target.value)},children:b})},x=n(81),v=(n(199),function(e){var t=Object(r.useState)([]),n=Object(i.a)(t,2),o=n[0],c=n[1],a=Object(s.c)((function(e){return e.auth})),u=Object(s.b)();Object(r.useEffect)((function(){if(a.loggedIn&&e.sensor){var t='https://glusfqycvwrucp9-db202012181437.adb.eu-zurich-1.oraclecloudapps.com/ords/sensor_datalake/sens/measurements?q={"sensor_uuid":{"$eq":"'.concat(e.sensor,'"},"$orderby":{"insert_timestamp":"desc"}}'),n=new Headers;n.set("Authorization","Basic ".concat(a.token)),fetch(t,{method:"GET",headers:n}).then((function(e){return e.ok?e.json():(u(m()),Promise.reject(new Error(e.statusText)))})).then((function(e){c(e.items)})).catch((function(e){return console.log(e)}))}else c([])}),[u,e,a]);var l={datasets:[{label:"CO2",data:o.map((function(e){return{x:e.insert_timestamp,y:e.co2}})),fill:!1,backgroundColor:"rgb(255, 99, 132)",borderColor:"rgba(255, 99, 132, 0.2)"},{label:"Temperature",data:o.map((function(e){return{x:e.insert_timestamp,y:e.temperature}})),fill:!1,backgroundColor:"rgb(255, 159, 64)",borderColor:"rgba(255, 159, 64, 0.2)"},{label:"Humidity",data:o.map((function(e){return{x:e.insert_timestamp,y:e.humidity}})),fill:!1,backgroundColor:"rgb(255, 205, 86)",borderColor:"rgba(255, 205, 86, 0.2)"}]};return Object(f.jsx)("div",{className:"Chart",children:Object(f.jsx)(x.a,{data:l,options:{animation:!1,scales:{x:{type:"time",time:{unit:"hour",displayFormats:{hour:"HH:mm",day:"DD.MM.YYYY"}}},y:{suggestedMin:0}}}})})}),y=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(""),a=Object(i.a)(c,2),u=a[0],l=a[1],d=Object(s.b)();return Object(f.jsx)("div",{className:"login-wrapper",children:Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault(),d(g(btoa("".concat(n,":").concat(u))))},children:[Object(f.jsxs)("label",{children:[Object(f.jsx)("p",{children:"Username"}),Object(f.jsx)("input",{type:"text",onChange:function(e){return o(e.target.value)}})]}),Object(f.jsxs)("label",{children:[Object(f.jsx)("p",{children:"Password"}),Object(f.jsx)("input",{type:"password",onChange:function(e){return l(e.target.value)}})]}),Object(f.jsx)("div",{children:Object(f.jsx)("button",{type:"submit",children:"Login"})})]})})};var k=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],o=t[1];return Object(s.c)((function(e){return e.auth})).loggedIn?Object(f.jsx)("div",{className:"wrapper",children:Object(f.jsx)(u.a,{children:Object(f.jsxs)(l.c,{children:[Object(f.jsx)(l.a,{path:"/logout",children:Object(f.jsx)("h1",{children:"Logout"})}),Object(f.jsxs)(l.a,{path:"/",children:[Object(f.jsx)(p,{onSensorChange:o}),Object(f.jsx)(v,{sensor:n})]})]})})}):Object(f.jsx)(y,{})},C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,204)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),c(e),a(e)}))},S=Object(d.a)({reducer:{auth:O}});a.a.render(Object(f.jsx)(o.a.StrictMode,{children:Object(f.jsx)(s.a,{store:S,children:Object(f.jsx)(k,{})})}),document.getElementById("root")),C()},91:function(e,t,n){},92:function(e,t,n){}},[[203,1,2]]]);
//# sourceMappingURL=main.f4fbd375.chunk.js.map