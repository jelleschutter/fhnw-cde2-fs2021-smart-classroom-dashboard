(this["webpackJsonpsmart-classroom-dashboard"]=this["webpackJsonpsmart-classroom-dashboard"]||[]).push([[0],{134:function(t,e,n){},135:function(t,e,n){},246:function(t,e,n){},252:function(t,e,n){"use strict";n.r(e);var c=n(0),r=n.n(c),a=n(14),o=n.n(a),i=n(34),s=n(299),u=(n(134),n(39)),l=n(13),d=(n(135),n(19)),j=n(285),b=n(28),h=n(66),m=localStorage.getItem("token"),O={loggedIn:!!m,token:m},f=Object(h.b)({name:"auth",initialState:O,reducers:{login:function(t,e){t.loggedIn=!0,t.token=e.payload,localStorage.setItem("token",e.payload)},logout:function(t){t.loggedIn=!1,t.token="",localStorage.removeItem("token")}}}),x=f.actions,p=x.login,g=x.logout,v=f.reducer,y=Object(h.a)({reducer:{auth:v}}),S=function(t,e,n){var c=y.getState().auth,r="https://glusfqycvwrucp9-db202012181437.adb.eu-zurich-1.oraclecloudapps.com/ords/sensor_datalake/sens".concat(t),a=[];e&&a.push("q=".concat(JSON.stringify(e))),n&&Object.keys(n).forEach((function(t){a.push("".concat(t,"=").concat(n[t]))})),a.length>0&&(r+="?".concat(a.join("&")));var o=new Headers;return o.set("Authorization","Basic ".concat(c.token)),fetch(r,{method:"GET",headers:o}).then((function(t){return t.ok?t.json():(y.dispatch(g()),Promise.reject(new Error(t.statusText)))}))},w=function t(e,n,c){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return S(e,n,c).then((function(a){var o=r.concat(a.items);if(a.hasMore){var i=Object(b.a)({offset:0},c);return i.offset+=a.count,t(e,n,i,o)}return o}))},C=n(116),k=(n(241),n(4)),I=function(t){var e=t.items,n={datasets:[{label:"CO2",data:e.map((function(t){return{x:t.insert_timestamp,y:t.co2}})),fill:!1,backgroundColor:"rgb(255, 99, 132)",borderColor:"rgba(255, 99, 132, 0.2)"},{label:"Temperature",data:e.map((function(t){return{x:t.insert_timestamp,y:t.temperature}})),fill:!1,backgroundColor:"rgb(255, 159, 64)",borderColor:"rgba(255, 159, 64, 0.2)"},{label:"Humidity",data:e.map((function(t){return{x:t.insert_timestamp,y:t.humidity}})),fill:!1,backgroundColor:"rgb(255, 205, 86)",borderColor:"rgba(255, 205, 86, 0.2)"},{label:"Distance",data:e.map((function(t){return{x:t.insert_timestamp,y:t.distance}})),fill:!1,backgroundColor:"rgb(75, 192, 192)",borderColor:"rgba(75, 192, 192, 0.2)"}]};return Object(k.jsx)(C.a,{type:"line",data:n,options:{animation:!1,scales:{x:{type:"time",time:{unit:"hour",displayFormats:{hour:"HH:mm",day:"DD.MM.YYYY"}}},y:{suggestedMin:0}}}})},N=function(){var t=Object(c.useState)(),e=Object(d.a)(t,2),n=e[0],r=e[1],a=Object(c.useState)([]),o=Object(d.a)(a,2),i=o[0],s=o[1],u=Object(l.g)().uuid;return Object(c.useEffect)((function(){var t=function(){if(u){var t=new Date;t.setHours(t.getHours()-12),w("/sensors/".concat(u,"/measurements"),{insert_timestamp:{$gte:{$date:t.toISOString()}},$orderby:{insert_timestamp:"desc"}}).then((function(t){s(t)})).catch((function(t){return console.log(t)})),(e="/sensors/".concat(u),S(e,n,c)).then((function(t){r(t)})).catch((function(t){console.log(t)}))}else s([]),r(void 0);var e,n,c};t();var e=setInterval((function(){t()}),3e4);return function(){return clearInterval(e)}}),[u]),Object(k.jsxs)(j.a,{children:[Object(k.jsx)("h2",{children:null===n||void 0===n?void 0:n.title}),Object(k.jsxs)("p",{children:["Count: ",i.length]}),Object(k.jsx)(I,{items:i})]})},_=(n(246),n(118)),F=n(289),D=n(300),E=n(290),H=function(){var t=Object(c.useState)(""),e=Object(d.a)(t,2),n=e[0],r=e[1],a=Object(c.useState)(""),o=Object(d.a)(a,2),s=o[0],u=o[1],l=Object(i.b)();return Object(k.jsx)("div",{className:"login-wrapper",children:Object(k.jsx)(_.a,{children:Object(k.jsx)("form",{onSubmit:function(t){t.preventDefault(),l(p(btoa("".concat(n,":").concat(s))))},children:Object(k.jsxs)(F.a,{container:!0,direction:"column",justify:"center",alignItems:"center",spacing:2,children:[Object(k.jsx)(F.a,{item:!0,children:Object(k.jsx)(D.a,{label:"Username",onChange:function(t){return r(t.target.value)}})}),Object(k.jsx)(F.a,{item:!0,children:Object(k.jsx)(D.a,{type:"password",label:"Password",onChange:function(t){return u(t.target.value)}})}),Object(k.jsx)(F.a,{item:!0,children:Object(k.jsx)(E.a,{type:"submit",children:"Login"})})]})})})})},T=function(){return Object(i.b)()(g()),Object(k.jsx)(l.a,{to:"/"})},z=n(291),B=n(301),$=n(292),q=n(293),M=n(295),L=n(294),P=n(115),Y=n.n(P),G=Object(z.a)((function(t){return Object(B.a)({root:{flexGrow:1},menuButton:{marginRight:t.spacing(2)},title:{flexGrow:1,color:"inherit",textDecoration:"none"}})})),J=function(){var t=G();return Object(k.jsx)("div",{className:t.root,children:Object(k.jsx)($.a,{position:"static",children:Object(k.jsxs)(q.a,{children:[Object(k.jsx)(L.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",children:Object(k.jsx)(Y.a,{})}),Object(k.jsx)(M.a,{component:u.b,variant:"h6",className:t.title,to:"/dashboard",children:"Smart Classroom"}),Object(k.jsx)(E.a,{component:u.b,color:"inherit",to:"/logout",children:"Logout"})]})})})},W=n(296),A=n(297),R=n(298),U=Object(z.a)({root:{minWidth:275},title:{fontSize:13},attribute:{marginTop:10,fontSize:13},uuid:{fontSize:14,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}),V=function(t){var e=t.sensor,n=U(),r=Object(c.useState)(),a=Object(d.a)(r,2),o=a[0],i=a[1];return Object(c.useEffect)((function(){var t=function(){e?S('/measurements?q={"sensor_uuid":{"$eq":"'.concat(e.uuid,'"},"$orderby":{"insert_timestamp":"desc"}}?limit=1')).then((function(t){t.count>0&&i(t.items[0])})).catch((function(t){console.log(t)})):i(void 0)};t();var n=setInterval((function(){t()}),15e3);return function(){return clearInterval(n)}}),[e]),Object(k.jsxs)(W.a,{className:n.root,children:[Object(k.jsxs)(A.a,{children:[Object(k.jsx)(M.a,{className:n.title,color:"textSecondary",gutterBottom:!0,children:"Sensor"}),Object(k.jsx)(M.a,{variant:"h6",component:"h2",children:e.title}),Object(k.jsx)(M.a,{className:n.uuid,variant:"body2",color:"textSecondary",children:e.uuid}),Object(k.jsx)(M.a,{className:n.attribute,color:"textSecondary",children:"CO2"}),Object(k.jsxs)(M.a,{variant:"body1",component:"p",children:[o?o.co2.toFixed(0):""," ppm"]}),Object(k.jsx)(M.a,{className:n.attribute,color:"textSecondary",children:"Temperature"}),Object(k.jsxs)(M.a,{variant:"body1",component:"p",children:[o?o.temperature.toFixed(1):""," C\xb0"]}),Object(k.jsx)(M.a,{className:n.attribute,color:"textSecondary",children:"Humidity"}),Object(k.jsxs)(M.a,{variant:"body1",component:"p",children:[o?o.humidity.toFixed(0):"","%"]})]}),Object(k.jsx)(R.a,{children:Object(k.jsx)(E.a,{component:u.b,size:"small",to:"/explore/".concat(e.uuid),children:"View latest data"})})]})},K=Object(z.a)((function(t){return Object(B.a)({root:{display:"flex",flexWrap:"wrap","& > *":{margin:t.spacing(1),width:t.spacing(16)}}})})),Q=function(){var t=K(),e=Object(c.useState)([]),n=Object(d.a)(e,2),r=n[0],a=n[1];Object(c.useEffect)((function(){S('/sensors?q={"$orderby":{"title":"asc"}}').then((function(t){a(t.items)})).catch((function(t){console.log(t)}))}),[]);var o=r.map((function(t){return Object(k.jsx)(V,{sensor:t},t.uuid)}));return Object(k.jsx)("div",{className:t.root,children:o})};var X=function(){return Object(i.c)((function(t){return t.auth})).loggedIn?Object(k.jsxs)(u.a,{children:[Object(k.jsx)(J,{}),Object(k.jsxs)(l.d,{children:[Object(k.jsx)(l.b,{path:"/logout",children:Object(k.jsx)(T,{})}),Object(k.jsx)(l.b,{path:"/dashboard",children:Object(k.jsx)(Q,{})}),Object(k.jsx)(l.b,{path:"/explore/:uuid",children:Object(k.jsx)(N,{})}),Object(k.jsx)(l.b,{path:"/",children:Object(k.jsx)(l.a,{to:"/dashboard"})})]})]}):Object(k.jsx)(H,{})},Z=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,303)).then((function(e){var n=e.getCLS,c=e.getFID,r=e.getFCP,a=e.getLCP,o=e.getTTFB;n(t),c(t),r(t),a(t),o(t)}))};o.a.render(Object(k.jsx)(r.a.StrictMode,{children:Object(k.jsxs)(i.a,{store:y,children:[Object(k.jsx)(s.a,{}),Object(k.jsx)(X,{})]})}),document.getElementById("root")),Z()}},[[252,1,2]]]);
//# sourceMappingURL=main.c6d062d9.chunk.js.map