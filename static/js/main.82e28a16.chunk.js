(this["webpackJsonpsmart-classroom-dashboard"]=this["webpackJsonpsmart-classroom-dashboard"]||[]).push([[0],{203:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),c=n(37),a=n.n(c),s=n(9),i=(n(91),n(16)),u=n(80),l=n(3),d=(n(92),n(38)),b=localStorage.getItem("token"),j={loggedIn:!!b,token:b},h=Object(d.b)({name:"auth",initialState:j,reducers:{login:function(e,t){e.loggedIn=!0,e.token=t.payload,localStorage.setItem("token",t.payload)},logout:function(e){e.loggedIn=!1,e.token="",localStorage.setItem("token",null)}}}),g=h.actions,m=g.login,O=g.logout,f=h.reducer,p=n(1),x=function(e){var t=e.onSensorChange,n=Object(r.useState)([]),o=Object(i.a)(n,2),c=o[0],a=o[1],u=Object(s.b)(),l=Object(s.c)((function(e){return e.auth}));Object(r.useEffect)((function(){if(l.loggedIn){var e=new Headers;e.set("Authorization","Basic ".concat(l.token)),fetch('https://glusfqycvwrucp9-db202012181437.adb.eu-zurich-1.oraclecloudapps.com/ords/sensor_datalake/sens/sensors?q={"$orderby":{"title":"asc"}}',{method:"GET",headers:e}).then((function(e){return e.ok?e.json():(u(O()),Promise.reject(new Error(e.statusText)))})).then((function(e){var n,r,o=null!==(n=null===(r=e.items[0])||void 0===r?void 0:r.uuid)&&void 0!==n?n:"";a(e.items),t(o)})).catch((function(e){console.log(e),t("")}))}else a([])}),[u,t,l]);var d=c.map((function(e){return Object(p.jsx)("option",{value:e.uuid,children:e.title},e.uuid)}));return Object(p.jsx)("select",{onChange:function(e){t(e.target.value)},children:d})},v=n(81),y=(n(199),function(e){var t=Object(r.useState)([]),n=Object(i.a)(t,2),o=n[0],c=n[1],a=Object(s.c)((function(e){return e.auth})),u=Object(s.b)();Object(r.useEffect)((function(){if(a.loggedIn&&e.sensor){var t='https://glusfqycvwrucp9-db202012181437.adb.eu-zurich-1.oraclecloudapps.com/ords/sensor_datalake/sens/measurements?q={"sensor_uuid":{"$eq":"'.concat(e.sensor,'"},"$orderby":{"insert_timestamp":"desc"}}'),n=new Headers;n.set("Authorization","Basic ".concat(a.token)),fetch(t,{method:"GET",headers:n}).then((function(e){return e.ok?e.json():(u(O()),Promise.reject(new Error(e.statusText)))})).then((function(e){c(e.items)})).catch((function(e){return console.log(e)}))}else c([])}),[u,e,a]);var l={datasets:[{label:"CO2",data:o.map((function(e){return{x:e.insert_timestamp,y:e.co2}})),fill:!1,backgroundColor:"rgb(255, 99, 132)",borderColor:"rgba(255, 99, 132, 0.2)"},{label:"Temperature",data:o.map((function(e){return{x:e.insert_timestamp,y:e.temperature}})),fill:!1,backgroundColor:"rgb(255, 159, 64)",borderColor:"rgba(255, 159, 64, 0.2)"},{label:"Humidity",data:o.map((function(e){return{x:e.insert_timestamp,y:e.humidity}})),fill:!1,backgroundColor:"rgb(255, 205, 86)",borderColor:"rgba(255, 205, 86, 0.2)"}]};return Object(p.jsx)("div",{className:"Chart",children:Object(p.jsx)(v.a,{data:l,options:{animation:!1,scales:{x:{type:"time",time:{unit:"hour",displayFormats:{hour:"HH:mm",day:"DD.MM.YYYY"}}},y:{suggestedMin:0}}}})})}),k=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(""),a=Object(i.a)(c,2),u=a[0],l=a[1],d=Object(s.b)();return Object(p.jsx)("div",{className:"login-wrapper",children:Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),d(m(btoa("".concat(n,":").concat(u))))},children:[Object(p.jsxs)("label",{children:[Object(p.jsx)("p",{children:"Username"}),Object(p.jsx)("input",{type:"text",onChange:function(e){return o(e.target.value)}})]}),Object(p.jsxs)("label",{children:[Object(p.jsx)("p",{children:"Password"}),Object(p.jsx)("input",{type:"password",onChange:function(e){return l(e.target.value)}})]}),Object(p.jsx)("div",{children:Object(p.jsx)("button",{type:"submit",children:"Login"})})]})})};var C=function(){var e=Object(r.useState)(""),t=Object(i.a)(e,2),n=t[0],o=t[1];return Object(s.c)((function(e){return e.auth})).loggedIn?Object(p.jsx)("div",{className:"wrapper",children:Object(p.jsx)(u.a,{children:Object(p.jsxs)(l.c,{children:[Object(p.jsx)(l.a,{path:"/logout",children:Object(p.jsx)("h1",{children:"Logout"})}),Object(p.jsxs)(l.a,{path:"/",children:[Object(p.jsx)(x,{onSensorChange:o}),Object(p.jsx)(y,{sensor:n})]})]})})}):Object(p.jsx)(k,{})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,204)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,c=t.getLCP,a=t.getTTFB;n(e),r(e),o(e),c(e),a(e)}))},w=Object(d.a)({reducer:{auth:f}});a.a.render(Object(p.jsx)(o.a.StrictMode,{children:Object(p.jsx)(s.a,{store:w,children:Object(p.jsx)(C,{})})}),document.getElementById("root")),S()},91:function(e,t,n){},92:function(e,t,n){}},[[203,1,2]]]);
//# sourceMappingURL=main.82e28a16.chunk.js.map