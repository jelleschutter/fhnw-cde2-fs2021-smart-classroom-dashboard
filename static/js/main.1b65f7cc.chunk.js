(this["webpackJsonpsmart-classroom-dashboard"]=this["webpackJsonpsmart-classroom-dashboard"]||[]).push([[0],{134:function(t,e,n){},135:function(t,e,n){},246:function(t,e,n){},252:function(t,e,n){"use strict";n.r(e);var c=n(0),r=n.n(c),a=n(14),o=n.n(a),i=n(33),s=n(298),u=(n(134),n(39)),l=n(13),d=(n(135),n(19)),b=n(65),j=localStorage.getItem("token"),m={loggedIn:!!j,token:j},h=Object(b.b)({name:"auth",initialState:m,reducers:{login:function(t,e){t.loggedIn=!0,t.token=e.payload,localStorage.setItem("token",e.payload)},logout:function(t){t.loggedIn=!1,t.token="",localStorage.removeItem("token")}}}),O=h.actions,x=O.login,f=O.logout,p=h.reducer,g=Object(b.a)({reducer:{auth:p}}),v=function(t){var e=g.getState().auth,n="https://glusfqycvwrucp9-db202012181437.adb.eu-zurich-1.oraclecloudapps.com/ords/sensor_datalake/sens".concat(t),c=new Headers;return c.set("Authorization","Basic ".concat(e.token)),fetch(n,{method:"GET",headers:c}).then((function(t){return t.ok?t.json():(g.dispatch(f()),Promise.reject(new Error(t.statusText)))}))},y=n(116),S=(n(241),n(4)),w=function(t){var e=t.items,n={datasets:[{label:"CO2",data:e.map((function(t){return{x:t.insert_timestamp,y:t.co2}})),fill:!1,backgroundColor:"rgb(255, 99, 132)",borderColor:"rgba(255, 99, 132, 0.2)"},{label:"Temperature",data:e.map((function(t){return{x:t.insert_timestamp,y:t.temperature}})),fill:!1,backgroundColor:"rgb(255, 159, 64)",borderColor:"rgba(255, 159, 64, 0.2)"},{label:"Humidity",data:e.map((function(t){return{x:t.insert_timestamp,y:t.humidity}})),fill:!1,backgroundColor:"rgb(255, 205, 86)",borderColor:"rgba(255, 205, 86, 0.2)"},{label:"Distance",data:e.map((function(t){return{x:t.insert_timestamp,y:t.distance}})),fill:!1,backgroundColor:"rgb(75, 192, 192)",borderColor:"rgba(75, 192, 192, 0.2)"}]};return Object(S.jsx)(y.a,{type:"line",data:n,options:{animation:!1,scales:{x:{type:"time",time:{unit:"hour",displayFormats:{hour:"HH:mm",day:"DD.MM.YYYY"}}},y:{suggestedMin:0}}}})},C=function(){var t=Object(c.useState)(),e=Object(d.a)(t,2),n=e[0],r=e[1],a=Object(c.useState)([]),o=Object(d.a)(a,2),i=o[0],s=o[1],u=Object(l.g)().uuid;return Object(c.useEffect)((function(){var t=function(){u?(v('/measurements?q={"sensor_uuid":{"$eq":"'.concat(u,'"},"$orderby":{"insert_timestamp":"desc"}}')).then((function(t){s(t.items)})).catch((function(t){return console.log(t)})),v('/sensors?q={"uuid":{"$eq":"'.concat(u,'"}}')).then((function(t){t.count>0?r(t.items[0]):r(void 0)})).catch((function(t){return console.log(t)}))):(s([]),r(void 0))};t();var e=setInterval((function(){t()}),3e4);return function(){return clearInterval(e)}}),[u]),Object(S.jsxs)("div",{className:"explore-wrapper",children:[Object(S.jsx)("h2",{children:null===n||void 0===n?void 0:n.title}),Object(S.jsx)(w,{items:i})]})},k=(n(246),n(117)),I=n(288),N=n(299),_=n(289),q=function(){var t=Object(c.useState)(""),e=Object(d.a)(t,2),n=e[0],r=e[1],a=Object(c.useState)(""),o=Object(d.a)(a,2),s=o[0],u=o[1],l=Object(i.b)();return Object(S.jsx)("div",{className:"login-wrapper",children:Object(S.jsx)(k.a,{children:Object(S.jsx)("form",{onSubmit:function(t){t.preventDefault(),l(x(btoa("".concat(n,":").concat(s))))},children:Object(S.jsxs)(I.a,{container:!0,direction:"column",justify:"center",alignItems:"center",spacing:2,children:[Object(S.jsx)(I.a,{item:!0,children:Object(S.jsx)(N.a,{label:"Username",onChange:function(t){return r(t.target.value)}})}),Object(S.jsx)(I.a,{item:!0,children:Object(S.jsx)(N.a,{type:"password",label:"Password",onChange:function(t){return u(t.target.value)}})}),Object(S.jsx)(I.a,{item:!0,children:Object(S.jsx)(_.a,{type:"submit",children:"Login"})})]})})})})},M=function(){return Object(i.b)()(f()),Object(S.jsx)(l.a,{to:"/"})},T=n(290),z=n(300),B=n(291),D=n(292),E=n(294),$=n(293),F=n(115),H=n.n(F),L=Object(T.a)((function(t){return Object(z.a)({root:{flexGrow:1},menuButton:{marginRight:t.spacing(2)},title:{flexGrow:1,color:"inherit",textDecoration:"none"}})})),P=function(){var t=L();return Object(S.jsx)("div",{className:t.root,children:Object(S.jsx)(B.a,{position:"static",children:Object(S.jsxs)(D.a,{children:[Object(S.jsx)($.a,{edge:"start",className:t.menuButton,color:"inherit","aria-label":"menu",children:Object(S.jsx)(H.a,{})}),Object(S.jsx)(E.a,{component:u.b,variant:"h6",className:t.title,to:"/dashboard",children:"Smart Classroom"}),Object(S.jsx)(_.a,{component:u.b,color:"inherit",to:"/logout",children:"Logout"})]})})})},Y=n(295),G=n(296),J=n(297),W=Object(T.a)({root:{minWidth:275},title:{fontSize:13},attribute:{marginTop:10,fontSize:13},uuid:{fontSize:14,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}),A=function(t){var e=t.sensor,n=W(),r=Object(c.useState)(),a=Object(d.a)(r,2),o=a[0],i=a[1];return Object(c.useEffect)((function(){var t=function(){e?v('/measurements?q={"sensor_uuid":{"$eq":"'.concat(e.uuid,'"},"$orderby":{"insert_timestamp":"desc"}}?limit=1')).then((function(t){t.count>0&&i(t.items[0])})).catch((function(t){console.log(t)})):i(void 0)};t();var n=setInterval((function(){t()}),15e3);return function(){return clearInterval(n)}}),[e]),Object(S.jsxs)(Y.a,{className:n.root,children:[Object(S.jsxs)(G.a,{children:[Object(S.jsx)(E.a,{className:n.title,color:"textSecondary",gutterBottom:!0,children:"Sensor"}),Object(S.jsx)(E.a,{variant:"h6",component:"h2",children:e.title}),Object(S.jsx)(E.a,{className:n.uuid,variant:"body2",color:"textSecondary",children:e.uuid}),Object(S.jsx)(E.a,{className:n.attribute,color:"textSecondary",children:"CO2"}),Object(S.jsxs)(E.a,{variant:"body1",component:"p",children:[o?Math.round(o.co2):""," ppm"]}),Object(S.jsx)(E.a,{className:n.attribute,color:"textSecondary",children:"Temperature"}),Object(S.jsxs)(E.a,{variant:"body1",component:"p",children:[o?Math.round(o.temperature):""," C\xb0"]}),Object(S.jsx)(E.a,{className:n.attribute,color:"textSecondary",children:"Humidity"}),Object(S.jsxs)(E.a,{variant:"body1",component:"p",children:[o?Math.round(o.humidity):"","%"]})]}),Object(S.jsx)(J.a,{children:Object(S.jsx)(_.a,{component:u.b,size:"small",to:"/explore/".concat(e.uuid),children:"View latest data"})})]})},R=Object(T.a)((function(t){return Object(z.a)({root:{display:"flex",flexWrap:"wrap","& > *":{margin:t.spacing(1),width:t.spacing(16)}}})})),U=function(){var t=R(),e=Object(c.useState)([]),n=Object(d.a)(e,2),r=n[0],a=n[1];Object(c.useEffect)((function(){v('/sensors?q={"$orderby":{"title":"asc"}}').then((function(t){a(t.items)})).catch((function(t){console.log(t)}))}));var o=r.map((function(t){return Object(S.jsx)(A,{sensor:t},t.uuid)}));return Object(S.jsx)("div",{className:t.root,children:o})};var V=function(){return Object(i.c)((function(t){return t.auth})).loggedIn?Object(S.jsxs)(u.a,{children:[Object(S.jsx)(P,{}),Object(S.jsxs)(l.d,{children:[Object(S.jsx)(l.b,{path:"/logout",children:Object(S.jsx)(M,{})}),Object(S.jsx)(l.b,{path:"/dashboard",children:Object(S.jsx)(U,{})}),Object(S.jsx)(l.b,{path:"/explore/:uuid",children:Object(S.jsx)(C,{})}),Object(S.jsx)(l.b,{path:"/",children:Object(S.jsx)(l.a,{to:"/dashboard"})})]})]}):Object(S.jsx)(q,{})},K=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,302)).then((function(e){var n=e.getCLS,c=e.getFID,r=e.getFCP,a=e.getLCP,o=e.getTTFB;n(t),c(t),r(t),a(t),o(t)}))};o.a.render(Object(S.jsx)(r.a.StrictMode,{children:Object(S.jsxs)(i.a,{store:g,children:[Object(S.jsx)(s.a,{}),Object(S.jsx)(V,{})]})}),document.getElementById("root")),K()}},[[252,1,2]]]);
//# sourceMappingURL=main.1b65f7cc.chunk.js.map